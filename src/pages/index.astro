---
import { getEntry } from "astro:content";
import Layout from "../layouts/Layout.astro";
import HeroSection from "../components/home/HeroSection.astro";
import LogoSlider from "../components/home/LogoSlider.astro";
import AboutUs from "../components/home/AboutUs.astro";
import ServicesSection from "../components/home/ServicesSection.astro";
import CaseStudiesSection from "../components/home/CaseStudiesSection.astro";
import ContactsSection from "../components/home/ContactsSection.astro";
import Prefooter from "../components/home/Prefooter.astro";

// 1. Fetch ALL homepage content in one go
const homepageEntry = await getEntry("pages", "homepage");
const data = homepageEntry?.data;

// Robust check
if (!data) {
  throw new Error("Homepage data missing. Please check src/content/pages/homepage.json");
}

// Destructure for cleaner template
const { hero, about, services, caseStudies, clients, contacts, prefooter } = data;
---

<Layout title="Sítovka.net | Marketingová Agentura">
  {hero && <HeroSection data={hero} />}
  
  {about && <AboutUs data={about} />}

  {services && <ServicesSection data={services} />}

  {caseStudies && <CaseStudiesSection data={caseStudies} />}

  {clients && <LogoSlider data={clients} />}

  {contacts && <ContactsSection data={contacts} />}

  {prefooter && <Prefooter data={prefooter} />}
</Layout>
